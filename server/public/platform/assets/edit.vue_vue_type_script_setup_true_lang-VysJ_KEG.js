import{C as A,A as F,B,e as I}from"./element-plus-CSiqOtzA.js";import{_ as j}from"./picker-CrueE0_N.js";import{u as D,a as N,g as P}from"./consumer-Ct-DHQt0.js";import{P as S}from"./index-DmpJxzQZ.js";import{u as w}from"./getExposeType-C5XerQxt.js";import{d as T,r as g,b as k,Z as L,o as M,L as Z,M as n,V as t,u as a,a as i}from"./@vue-TMcuEboY.js";const Q=T({__name:"edit",props:{tenant_id:{type:Number}},emits:["refresh","close"],setup(V,{expose:b,emit:E}){const u=V,_=E,c=w(),p=w(),m=g("add"),x=k(()=>m.value=="edit"?"编辑管理员":"新增管理员"),o=g({id:"",account:"",name:"",dept_id:[],jobs_id:[],role_id:[],avatar:"",password:"",password_confirm:"",disable:0,multipoint_login:1,root:0}),v=(s,e,l)=>{o.value.password&&(e||l(new Error("请再次输入密码")),e!==o.value.password&&l(new Error("两次输入密码不一致!"))),l()},f=L({account:[{required:!0,message:"请输入账号",trigger:["blur"]}],name:[{required:!0,message:"请输入名称",trigger:["blur"]}],role_id:[{required:!0,validator:(s,e,l)=>{o.value.root||o.value.role_id.length?l():l(new Error("请选择角色"))}}],password:[{required:!0,message:"请输入密码",trigger:["blur"]}],password_confirm:[{required:!0,message:"请输入确认密码",trigger:["blur"]},{validator:v,trigger:"blur"}]}),C=async()=>{var s,e;await((s=c.value)==null?void 0:s.validate()),m.value=="edit"?await D({...o.value,tenant_id:u.tenant_id}):await N({...o.value,tenant_id:u.tenant_id}),(e=p.value)==null||e.close(),_("refresh")},y=(s="add",e)=>{var l;e&&R(e),m.value=s,(l=p.value)==null||l.open()},R=async s=>{f.password=[],f.password_confirm=[{validator:v,trigger:"blur"}];const e=await P({id:s,tenant_id:u.tenant_id});o.value=e};return b({open:y}),(s,e)=>{const l=F,d=B,U=j,q=I;return M(),Z(S,{ref_key:"popupRef",ref:p,title:a(x),async:!0,width:"550px",onConfirm:C,onClose:e[6]||(e[6]=r=>_("close"))},{default:n(()=>[t(a(A),{ref_key:"editFormRef",ref:c,model:a(o),"label-width":"84px",rules:a(f)},{default:n(()=>[t(d,{label:"账号",prop:"account"},{default:n(()=>[t(l,{modelValue:a(o).account,"onUpdate:modelValue":e[0]||(e[0]=r=>a(o).account=r),disabled:a(o).root==1,placeholder:"请输入账号",clearable:""},null,8,["modelValue","disabled"])]),_:1}),t(d,{label:"头像",prop:"avatar"},{default:n(()=>[i("div",null,[i("div",null,[t(U,{modelValue:a(o).avatar,"onUpdate:modelValue":e[1]||(e[1]=r=>a(o).avatar=r),limit:1},null,8,["modelValue"])]),e[7]||(e[7]=i("div",{class:"form-tips"},"建议尺寸：100*100px，支持jpg，jpeg，png格式",-1))])]),_:1}),t(d,{label:"名称",prop:"name"},{default:n(()=>[t(l,{modelValue:a(o).name,"onUpdate:modelValue":e[2]||(e[2]=r=>a(o).name=r),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"密码",prop:"password"},{default:n(()=>[t(l,{modelValue:a(o).password,"onUpdate:modelValue":e[3]||(e[3]=r=>a(o).password=r),"show-password":"",clearable:"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(d,{label:"确认密码",prop:"password_confirm"},{default:n(()=>[t(l,{modelValue:a(o).password_confirm,"onUpdate:modelValue":e[4]||(e[4]=r=>a(o).password_confirm=r),"show-password":"",clearable:"",placeholder:"请输入确认密码"},null,8,["modelValue"])]),_:1}),t(d,{label:"多处登录",prop:"multipoint_login"},{default:n(()=>[i("div",null,[t(q,{modelValue:a(o).multipoint_login,"onUpdate:modelValue":e[5]||(e[5]=r=>a(o).multipoint_login=r),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e[8]||(e[8]=i("div",{class:"form-tips"},"允许多人同时在线登录",-1))])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}});export{Q as _};
