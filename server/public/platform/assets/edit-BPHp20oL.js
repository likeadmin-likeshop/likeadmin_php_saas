import{a as T,p as Z,g as ee,B as ae,A as te,L as le,M as oe,R as se,C as ne,k as ie,l as re,h as me,O as de}from"./element-plus-CSiqOtzA.js";import{_ as pe}from"./picker-BEke1FBi.js";import{b as ue,d as _e}from"./index-wB8vo7oM.js";import{e as fe,f as ce}from"./consumer-BXxjrn9s.js";import{u as ve}from"./useLockFn-BhPLnZje.js";import{_ as be}from"./index.vue_vue_type_script_setup_true_lang-EF7NSX3C.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-B3YQenXK.js";import{l as ge}from"./lodash-es-R-kYiKr_.js";import{d as xe,r as c,s as ke,an as Ve,o as i,L as m,M as l,O as F,c as v,a as p,V as o,u as e,T as d,S as u,R as w,i as L,P as we,n as Ee}from"./@vue-TMcuEboY.js";import"./async-validator-DKvM95Vc.js";import"./@element-plus-C2WBhajb.js";import"./dayjs-CMfar2R3.js";import"./balanced-match-mNcR6oh4.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@popperjs-D9SI2xQl.js";import"./index-D6Od-rUl.js";import"./index-DqLA5SfV.js";import"./index.vue_vue_type_script_setup_true_lang-ggB8NA6X.js";import"./index-BvcnTZ4a.js";import"./@vueuse-DE_336rM.js";import"./usePaging-DFi_nJOG.js";import"./vue3-video-play-xg7gp0Bu.js";import"./vuedraggable-OYPBN08G.js";import"./vue-CHxGqOme.js";import"./sortablejs-DdgKbxid.js";import"./nprogress-Cgf5DU8x.js";import"./vue-router-CZY6S6gL.js";import"./pinia-ebUeA1L2.js";import"./axios-C-n2IhIP.js";import"./lodash-BtPWuHkK.js";import"./css-color-function-rJvg8h-6.js";import"./color-B0v57BL7.js";import"./clone-CuIhj1wH.js";import"./color-convert-BGgJB5UM.js";import"./color-name-BQ5IbGbl.js";import"./color-string-BhgG7-8u.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-8CNoFg4V.js";import"./clipboard-Dch_ozqB.js";import"./echarts-BR_QmBtV.js";import"./tslib-BDyQ-Jie.js";import"./zrender-B-CeXLwU.js";import"./highlight.js-D5uP1KGk.js";import"./@highlightjs-KJi31KWJ.js";import"./index.vue_vue_type_script_setup_true_lang-sWT38h-C.js";import"./index.vue_vue_type_script_setup_true_lang-B2T1NVEp.js";import"./getExposeType-C5XerQxt.js";import"./edit.vue_vue_type_script_setup_true_lang-CIcjOZnx.js";import"./department-DzQiRquD.js";import"./post-D__2kFDw.js";import"./role-Cai7G6Sj.js";import"./useDictOptions-DGB2V_pO.js";import"./detail-sW5ExKrp.js";const Ce={class:"h-full flex flex-col","element-loading-text":"加载中...","element-loading-background":"var(--el-bg-color)"},De={class:"flex flex-col pb-1"},Ue={class:"bg-page p-4 rounded flex justify-between items-center"},Re={class:"flex items-center gap-4"},ze={class:"flex flex-col justify-center gap-1"},he={class:"font-bold text-lg"},Be={class:"text-info text-xs"},Te=["href"],Fe=["href"],Le={class:"flex items-center ml-2 cursor-pointer"},Ne={key:1,class:"break-all"},$e={key:1},Ie={key:1,class:"break-all"},Se={key:0},qe={key:1},Me=xe({__name:"edit",emits:["refresh"],setup(je,{expose:N,emit:$}){const y=c(!1),g=ke(),U=c(0),b=c("profile"),s=c(!1),R=c(),x=c(!0),t=c({avatar:"",create_time:"",name:"",sn:"",domain:"",default_domain:"",id:0,disable:0,tel:"",domain_alias:"",domain_alias_enable:1,notes:""}),I={name:[{required:!0,message:"请输入租户名称",trigger:["blur"]}],domain_alias_enable:[{validator:(r,a,_)=>{t.value.domain_alias===""&&t.value.domain_alias_enable===0?_(new Error("请先设置域名别名再启用")):_()},trigger:["change"]}]},S=$,q=(r,a,_)=>{x.value=!0,b.value=_||"profile",s.value=a||!1,z(r),U.value=r,y.value=!0},M=async()=>{if(s.value)try{await T.confirm("修改还未保存，确认退出编辑吗？"),E()}catch{return!1}},z=async r=>{const a=await fe({id:r});x.value=!1,t.value=a,R.value=ge(t.value)},j=r=>{s.value?T.confirm("修改还未保存，确认退出编辑吗？").then(()=>{r()}).catch(()=>{console.log("取消")}):r()},A=()=>{var r;(r=g.value)==null||r.resetFields()},E=async r=>{var a,_;s.value?r?(await((a=g.value)==null?void 0:a.validate()),await G()):(t.value=R.value,(_=g.value)==null||_.clearValidate()):(b.value="profile",await Ee()),s.value=!s.value},O=async()=>{x.value=!0,await ce(t.value),await z(U.value),S("refresh")},{isLock:P,lockFn:G}=ve(O);return N({openHandle:q}),(r,a)=>{const _=Z,C=ee,H=ue,f=ae,J=pe,k=te,V=le,h=oe,B=se,K=ne,D=ie,Q=re,W=me,X=Ve("copy"),Y=de;return i(),m(W,{modelValue:e(y),"onUpdate:modelValue":a[10]||(a[10]=n=>L(y)?y.value=n:null),"destroy-on-close":"",title:"租户信息",direction:"rtl",size:"50%",onClose:A,"before-close":j},{default:l(()=>[F((i(),v("div",Ce,[p("div",De,[p("div",Ue,[p("div",Re,[o(_,{src:e(t).avatar,size:58},null,8,["src"]),p("div",ze,[p("span",he,d(e(t).name),1),p("span",Be,"编号："+d(e(t).sn),1)])]),p("div",null,[o(C,{type:"info",size:"small"},{default:l(()=>[p("a",{href:e(t).domain,target:"_blank"},"登录",8,Te)]),_:1}),e(s)?(i(),m(C,{key:0,type:"default",size:"small",onClick:a[0]||(a[0]=n=>E())},{default:l(()=>a[11]||(a[11]=[u(" 取消 ")])),_:1})):w("",!0),o(C,{type:"primary",size:"small",loading:e(P),onClick:a[1]||(a[1]=n=>E(!0))},{default:l(()=>[u(d(e(s)?"保存":"编辑"),1)]),_:1},8,["loading"])])])]),o(Q,{class:"flex-1",modelValue:e(b),"onUpdate:modelValue":a[9]||(a[9]=n=>L(b)?b.value=n:null),"before-leave":M},{default:l(()=>[o(D,{label:"基础信息",name:"profile"},{default:l(()=>[o(K,{ref_key:"formRef",ref:g,class:we(["grid grid-cols-2 gap-x-4 pt-2",{"!grid-cols-1":e(s)}]),"label-position":"right",model:e(t),"label-width":"100px",rules:I},{default:l(()=>[e(s)?w("",!0):(i(),m(f,{key:0,label:"默认域名：",class:"col-span-2",prop:"default_domain"},{default:l(()=>[p("a",{href:e(t).default_domain,target:"_blank",rel:"noopener noreferrer"},d(e(t).default_domain||"--"),9,Fe),F((i(),v("span",Le,[o(H,{name:"el-icon-DocumentCopy"}),a[12]||(a[12]=u(" 复制 "))])),[[X,e(t).domain]])]),_:1})),e(s)?(i(),m(f,{key:1,label:"头像：",prop:"avatar"},{default:l(()=>[o(J,{modelValue:e(t).avatar,"onUpdate:modelValue":a[2]||(a[2]=n=>e(t).avatar=n),limit:1},null,8,["modelValue"])]),_:1})):w("",!0),o(f,{label:"租户名称：",prop:"name",required:e(s)},{default:l(()=>[e(s)?(i(),m(k,{key:0,modelValue:e(t).name,"onUpdate:modelValue":a[3]||(a[3]=n=>e(t).name=n),placeholder:"请输入租户名称",style:{"max-width":"250px"}},null,8,["modelValue"])):(i(),v("span",Ne,d(e(t).name||"--"),1))]),_:1},8,["required"]),o(f,{label:"联系方式：",prop:"tel"},{default:l(()=>[e(s)?(i(),m(k,{key:0,modelValue:e(t).tel,"onUpdate:modelValue":a[4]||(a[4]=n=>e(t).tel=n),placeholder:"请输入联系方式",style:{"max-width":"250px"}},null,8,["modelValue"])):(i(),v("span",$e,d(e(t).tel||"--"),1))]),_:1}),o(f,{label:"域名别名：",prop:"domain_alias"},{default:l(()=>[e(s)?(i(),m(k,{key:0,modelValue:e(t).domain_alias,"onUpdate:modelValue":a[5]||(a[5]=n=>e(t).domain_alias=n),placeholder:"请输入域名别名",style:{"max-width":"250px"}},null,8,["modelValue"])):(i(),v("span",Ie,d(e(t).domain_alias||"--"),1))]),_:1}),o(f,{label:"启用别名：",prop:"domain_alias_enable"},{default:l(()=>[e(s)?(i(),v("div",Se,[o(h,{modelValue:e(t).domain_alias_enable,"onUpdate:modelValue":a[6]||(a[6]=n=>e(t).domain_alias_enable=n)},{default:l(()=>[o(V,{value:0},{default:l(()=>a[13]||(a[13]=[u("启用")])),_:1}),o(V,{value:1},{default:l(()=>a[14]||(a[14]=[u("禁用")])),_:1})]),_:1},8,["modelValue"]),a[15]||(a[15]=p("p",{class:"text-info text-sm"}," Tips：项目线上部署后，配置好域名别名并解析到默认域名后启用即可生效 ",-1))])):(i(),m(B,{key:1,"disable-transitions":"",type:e(t).domain_alias_enable===0?"primary":"info"},{default:l(()=>[u(d(e(t).domain_alias_enable===0?"启用":"禁用"),1)]),_:1},8,["type"]))]),_:1}),o(f,{label:"租户状态：",prop:"disable"},{default:l(()=>[e(s)?(i(),m(h,{key:0,modelValue:e(t).disable,"onUpdate:modelValue":a[7]||(a[7]=n=>e(t).disable=n)},{default:l(()=>[o(V,{value:0},{default:l(()=>a[16]||(a[16]=[u("开启")])),_:1}),o(V,{value:1},{default:l(()=>a[17]||(a[17]=[u("关闭")])),_:1})]),_:1},8,["modelValue"])):(i(),m(B,{key:1,"disable-transitions":"",type:e(t).disable===0?"primary":"info"},{default:l(()=>[u(d(e(t).disable===0?"开启":"关闭"),1)]),_:1},8,["type"]))]),_:1}),e(s)?w("",!0):(i(),m(f,{key:2,label:"创建时间："},{default:l(()=>[u(d(e(t).create_time),1)]),_:1})),o(f,{label:"租户备注：",prop:"notes"},{default:l(()=>[e(s)?(i(),m(k,{key:0,modelValue:e(t).notes,"onUpdate:modelValue":a[8]||(a[8]=n=>e(t).notes=n),placeholder:"请输入租户备注",style:{"max-width":"250px"},type:"textarea",maxlength:100},null,8,["modelValue"])):(i(),v("span",qe,d(e(t).notes||"--"),1))]),_:1})]),_:1},8,["class","model"])]),_:1}),o(D,{lazy:"",label:"账号列表",name:"accounts"},{default:l(()=>[o(be,{tenant_id:e(t).id},null,8,["tenant_id"])]),_:1}),o(D,{lazy:"",label:"用户列表",name:"users"},{default:l(()=>[o(ye,{tenant_id:e(t).id},null,8,["tenant_id"])]),_:1})]),_:1},8,["modelValue"])])),[[Y,e(x)]])]),_:1},8,["modelValue"])}}}),Aa=_e(Me,[["__scopeId","data-v-11510c8e"]]);export{Aa as default};
