import{L as Q,C as I,i as Y,s as Z,r as ee,G as ue,H as le,T as oe,$ as te,D as se,g as ae,F as ne}from"./element-plus.e82904ed.js";import{k as de,l as ie,b as re,m as pe,M as c,n as me,t as ce}from"./index.a9f0184b.js";import{d as W,r as w,s as L,a1 as P,b as G,w as Fe,f as _e,o as m,c as B,X as o,P as t,u,O as f,W as O,U as E,a as s,$ as R,a8 as S,R as fe,V as Ee,n as q,T as b}from"./@vue.54440ad7.js";import{c as ve}from"./@vueuse.13464b8c.js";import{a as be,b as Ce,c as Ve,d as Be}from"./menu.a3f1b6e7.js";import{P as De}from"./index.9c50515f.js";const ye={class:"icon-select"},he={class:"flex justify-between"},Ae=s("div",{class:"mb-3"},"\u8BF7\u9009\u62E9\u56FE\u6807",-1),ke=["onClick"],ge={class:"h-[280px]"},Ue={class:"flex flex-wrap"},we={key:0,class:"flex items-center"},Te=W({__name:"picker",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(z,{emit:T}){const D=T,y=w(0),A=[{name:"element\u56FE\u6807",icons:de()},{name:"\u672C\u5730\u56FE\u6807",icons:ie()}],C=L(),a=P({inputValue:"",popoverVisible:!1,popoverWidth:0,mouseoverSelect:!1,inputFocus:!1}),x=()=>{a.inputFocus=a.popoverVisible=!0},g=()=>{a.inputFocus=!1,a.popoverVisible=a.mouseoverSelect},N=d=>{a.mouseoverSelect=a.popoverVisible=!1,D("update:modelValue",d),D("change",d)},l=()=>{D("update:modelValue",""),D("change","")},$=G(()=>{var _,V;const d=(V=(_=A[y.value])==null?void 0:_.icons)!=null?V:[];if(!a.inputValue)return d;const i=a.inputValue.toLowerCase();return d.filter(h=>{if(h.toLowerCase().indexOf(i)!==-1)return h})}),U=()=>{q(()=>{var i;const d=(i=C.value)==null?void 0:i.$el.offsetWidth;a.popoverWidth=d<300?300:d})};return ve(document.body,"click",()=>{a.popoverVisible=!!(a.inputFocus||a.mouseoverSelect)}),Fe(()=>a.popoverVisible,async d=>{var i,_;await q(),d?(i=C.value)==null||i.focus():(_=C.value)==null||_.blur()}),_e(()=>{U()}),(d,i)=>{const _=re,V=Y,h=Z,M=ee,r=Q;return m(),B("div",ye,[o(r,{trigger:"contextmenu",visible:a.popoverVisible,"onUpdate:visible":i[3]||(i[3]=e=>a.popoverVisible=e),width:a.popoverWidth},{reference:t(()=>[o(u(I),{ref_key:"inputRef",ref:C,modelValue:a.inputValue,"onUpdate:modelValue":i[2]||(i[2]=e=>a.inputValue=e),modelModifiers:{trim:!0},placeholder:"\u641C\u7D22\u56FE\u6807",autofocus:!1,disabled:d.disabled,onFocus:x,onBlur:g,clearable:""},{prepend:t(()=>[d.modelValue?(m(),B("div",we,[o(M,{class:"flex-1 w-20",content:d.modelValue,placement:"top"},{default:t(()=>[(m(),f(_,{class:"mr-1",key:d.modelValue,name:d.modelValue,size:16},null,8,["name"]))]),_:1},8,["content"])])):(m(),B(O,{key:1},[E("\u65E0")],64))]),append:t(()=>[o(V,null,{default:t(()=>[o(_,{name:"el-icon-Close",size:18,onClick:l})]),_:1})]),_:1},8,["modelValue","disabled"])]),default:t(()=>[s("div",{onMouseover:i[0]||(i[0]=R(e=>a.mouseoverSelect=!0,["stop"])),onMouseout:i[1]||(i[1]=R(e=>a.mouseoverSelect=!1,["stop"]))},[s("div",null,[s("div",he,[Ae,s("div",null,[(m(),B(O,null,S(A,(e,p)=>s("span",{key:p,class:fe(["cursor-pointer text-sm ml-2",{"text-primary":p==u(y)}]),onClick:v=>y.value=p},Ee(e.name),11,ke)),64))])]),s("div",ge,[o(h,null,{default:t(()=>[s("div",Ue,[(m(!0),B(O,null,S($.value,e=>(m(),B("div",{key:e,class:"m-1"},[o(V,{onClick:p=>N(e)},{default:t(()=>[o(_,{name:e,size:18},null,8,["name"])]),_:2},1032,["onClick"])]))),128))])]),_:1})])])],32)]),_:1},8,["visible","width"])])}}}),xe={class:"edit-popup"},Ne={class:"flex-1"},$e=s("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934 ",-1),Me={class:"flex-1"},Oe=s("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`user/setting`\uFF0C\u9ED8\u8BA4\u5728`views`\u76EE\u5F55\u4E0B ",-1),Le={class:"flex-1"},Re=s("div",{class:"form-tips"}," \u8BBF\u95EE\u8BE6\u60C5\u9875\u9762\uFF0C\u7F16\u8F91\u9875\u9762\u65F6\uFF0C\u83DC\u5355\u9AD8\u4EAE\u663E\u793A\uFF0C\u5982`/consumer/lists` ",-1),Se={class:"flex-1"},qe=s("div",{class:"form-tips"}," \u5C06\u4F5C\u4E3Aserver\u7AEFAPI\u9A8C\u6743\u4F7F\u7528\uFF0C\u5982`auth.admin/user`\uFF0C\u8BF7\u8C28\u614E\u4FEE\u6539 ",-1),Ie={class:"flex-1"},We=s("div",{class:"form-tips"},' \u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A`{"id": 1, "name": "admin"}`\u6216`id=1&name=admin` ',-1),Pe=s("div",{class:"form-tips"},"\u9009\u62E9\u7F13\u5B58\u5219\u4F1A\u88AB`keep-alive`\u7F13\u5B58",-1),Ge=s("div",{class:"form-tips"}," \u9009\u62E9\u9690\u85CF\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE ",-1),ze=s("div",{class:"form-tips"},"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",-1),je=s("div",{class:"form-tips"},"\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),Ze=W({__name:"edit",emits:["success","close"],setup(z,{expose:T,emit:D}){const y=D,A=L(),C=L(),a=w("add"),x=G(()=>a.value=="edit"?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),g=w(pe()),N=(r,e)=>{const p=r?g.value.filter(v=>v.toLowerCase().includes(r.toLowerCase())):g.value;e(p.map(v=>({value:v})))},l=P({id:"",pid:0,type:c.CATALOGUE,icon:"",name:"",sort:0,paths:"",perms:"",component:"",selected:"",params:"",is_cache:1,is_show:1,is_disable:0}),$={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",trigger:["blur","change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"}],paths:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740",trigger:"blur"}],component:[{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"}]},U=w([]),d=async()=>{const r=await be({page_type:0}),e={id:0,name:"\u9876\u7EA7",children:[]};e.children=me(ce(r.lists).filter(p=>p.type!=c.BUTTON)),U.value.push(e)},i=async()=>{var r,e;await((r=A.value)==null?void 0:r.validate()),a.value=="edit"?await Ce(l):await Ve(l),(e=C.value)==null||e.close(),y("success")},_=(r="add")=>{var e;a.value=r,(e=C.value)==null||e.open()},V=r=>{for(const e in l)r[e]!=null&&r[e]!=null&&(l[e]=r[e])},h=async r=>{const e=await Be({id:r.id});V(e)},M=()=>{y("close")};return d(),T({open:_,setFormData:V,getDetail:h}),(r,e)=>{const p=ue,v=le,F=se,j=oe,k=I,H=Te,K=te,X=ae,J=ne;return m(),B("div",xe,[o(De,{ref_key:"popupRef",ref:C,title:u(x),async:!0,width:"550px",onConfirm:i,onClose:M},{default:t(()=>[o(J,{ref_key:"formRef",ref:A,model:u(l),"label-width":"80px",rules:$},{default:t(()=>[o(F,{label:"\u83DC\u5355\u7C7B\u578B",prop:"type",required:""},{default:t(()=>[o(v,{modelValue:u(l).type,"onUpdate:modelValue":e[0]||(e[0]=n=>u(l).type=n)},{default:t(()=>[o(p,{label:u(c).CATALOGUE},{default:t(()=>[E("\u76EE\u5F55")]),_:1},8,["label"]),o(p,{label:u(c).MENU},{default:t(()=>[E("\u83DC\u5355")]),_:1},8,["label"]),o(p,{label:u(c).BUTTON},{default:t(()=>[E("\u6309\u94AE")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),o(F,{label:"\u7236\u7EA7\u83DC\u5355",prop:"pid"},{default:t(()=>[o(j,{class:"flex-1",modelValue:u(l).pid,"onUpdate:modelValue":e[1]||(e[1]=n=>u(l).pid=n),data:u(U),clearable:"","node-key":"id",props:{label:"name"},"default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355","check-strictly":""},null,8,["modelValue","data"])]),_:1}),o(F,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:t(()=>[o(k,{modelValue:u(l).name,"onUpdate:modelValue":e[2]||(e[2]=n=>u(l).name=n),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u(l).type!=u(c).BUTTON?(m(),f(F,{key:0,label:"\u83DC\u5355\u56FE\u6807",prop:"icon"},{default:t(()=>[o(H,{class:"flex-1",modelValue:u(l).icon,"onUpdate:modelValue":e[3]||(e[3]=n=>u(l).icon=n)},null,8,["modelValue"])]),_:1})):b("",!0),u(l).type!=u(c).BUTTON?(m(),f(F,{key:1,label:"\u8DEF\u7531\u8DEF\u5F84",prop:"paths"},{default:t(()=>[s("div",Ne,[o(k,{modelValue:u(l).paths,"onUpdate:modelValue":e[4]||(e[4]=n=>u(l).paths=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),$e])]),_:1})):b("",!0),u(l).type==u(c).MENU?(m(),f(F,{key:2,label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:t(()=>[s("div",Me,[o(K,{class:"w-full",modelValue:u(l).component,"onUpdate:modelValue":e[5]||(e[5]=n=>u(l).component=n),"fetch-suggestions":N,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"]),Oe])]),_:1})):b("",!0),u(l).type==u(c).MENU?(m(),f(F,{key:3,label:"\u9009\u4E2D\u83DC\u5355",prop:"selected"},{default:t(()=>[s("div",Le,[o(k,{modelValue:u(l).selected,"onUpdate:modelValue":e[6]||(e[6]=n=>u(l).selected=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Re])]),_:1})):b("",!0),u(l).type!=u(c).CATALOGUE?(m(),f(F,{key:4,label:"\u6743\u9650\u5B57\u7B26",prop:"perms"},{default:t(()=>[s("div",Se,[o(k,{modelValue:u(l).perms,"onUpdate:modelValue":e[7]||(e[7]=n=>u(l).perms=n),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:""},null,8,["modelValue"]),qe])]),_:1})):b("",!0),u(l).type==u(c).MENU?(m(),f(F,{key:5,label:"\u8DEF\u7531\u53C2\u6570",prop:"params"},{default:t(()=>[s("div",null,[s("div",Ie,[o(k,{modelValue:u(l).params,"onUpdate:modelValue":e[8]||(e[8]=n=>u(l).params=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u53C2\u6570",clearable:""},null,8,["modelValue"])]),We])]),_:1})):b("",!0),u(l).type==u(c).MENU?(m(),f(F,{key:6,label:"\u662F\u5426\u7F13\u5B58",prop:"is_cache",required:""},{default:t(()=>[s("div",null,[o(v,{modelValue:u(l).is_cache,"onUpdate:modelValue":e[9]||(e[9]=n=>u(l).is_cache=n)},{default:t(()=>[o(p,{label:1},{default:t(()=>[E("\u7F13\u5B58")]),_:1}),o(p,{label:0},{default:t(()=>[E("\u4E0D\u7F13\u5B58")]),_:1})]),_:1},8,["modelValue"]),Pe])]),_:1})):b("",!0),u(l).type!=u(c).BUTTON?(m(),f(F,{key:7,label:"\u662F\u5426\u663E\u793A",prop:"is_show",required:""},{default:t(()=>[s("div",null,[o(v,{modelValue:u(l).is_show,"onUpdate:modelValue":e[10]||(e[10]=n=>u(l).is_show=n)},{default:t(()=>[o(p,{label:1},{default:t(()=>[E("\u663E\u793A")]),_:1}),o(p,{label:0},{default:t(()=>[E("\u9690\u85CF")]),_:1})]),_:1},8,["modelValue"]),Ge])]),_:1})):b("",!0),u(l).type!=u(c).BUTTON?(m(),f(F,{key:8,label:"\u83DC\u5355\u72B6\u6001",prop:"is_disable",required:""},{default:t(()=>[s("div",null,[o(v,{modelValue:u(l).is_disable,"onUpdate:modelValue":e[11]||(e[11]=n=>u(l).is_disable=n)},{default:t(()=>[o(p,{label:0},{default:t(()=>[E("\u6B63\u5E38")]),_:1}),o(p,{label:1},{default:t(()=>[E("\u505C\u7528")]),_:1})]),_:1},8,["modelValue"]),ze])]),_:1})):b("",!0),o(F,{label:"\u83DC\u5355\u6392\u5E8F",prop:"sort"},{default:t(()=>[s("div",null,[o(X,{modelValue:u(l).sort,"onUpdate:modelValue":e[12]||(e[12]=n=>u(l).sort=n),min:0,max:9999},null,8,["modelValue"]),je])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{Ze as _};
