import{L as U,C as Y,B as A,M as I,D as T}from"./element-plus-DYHMmEbd.js";import{r as g}from"./index-CR4R7Ze_.js";import{P as F}from"./index-C9g2zszt.js";import{d as G,s as y,Z as L,b as h,o as _,c as k,V as l,M as r,u as o,a as u,S as f,T as E,L as M,R as V}from"./@vue-pHjCrgw6.js";function te(){return g.get({url:"/setting.storage/lists"})}function P(d){return g.post({url:"/setting.storage/setup",params:d})}function Z(d){return g.get({url:"/setting.storage/detail",params:d})}const j={class:"edit-popup"},z={class:"form-tips"},H={key:0},J={class:"flex-1"},Q={class:"flex-1"},le=G({__name:"edit",emits:["success"],setup(d,{expose:C,emit:v}){const R=v,p=y(),m=y(),t=L({engine:"",bucket:"",access_key:"",secret_key:"",domain:"",region:"",status:0}),q=[{name:"本地存储",type:"local",tips:"本地存储方式不需要配置其他参数"},{name:"七牛云存储",type:"qiniu",tips:"切换七牛云存储后，素材库需要重新上传至七牛云"},{name:"阿里云OSS",type:"aliyun",tips:"切换阿里云OSS后，素材库需要重新上传至阿里云OSS"},{name:"腾讯云OSS",type:"qcloud",tips:"切换腾讯云OSS后，素材库需要重新上传至腾讯云OSS"}],x={bucket:[{required:!0,message:"请输入存储空间名称",trigger:"blur"}],access_key:[{required:!0,message:"请输入ACCESS_KEY",trigger:"blur"}],secret_key:[{required:!0,message:"请输入SECRET_KEY",trigger:"blur"}],domain:[{required:!0,message:"请输入空间域名",trigger:"blur"}],region:[{required:!0,message:"请输入REGION",trigger:"blur"}]},b=h(()=>q.find(s=>s.type==t.engine)),K=async()=>{var s,e;await((s=p.value)==null?void 0:s.validate()),await P(t),(e=m.value)==null||e.close(),R("success")},O=async()=>{const s=await Z({engine:t.engine});for(const e in s)t[e]=s[e]},w=s=>{var e;t.engine=s,(e=m.value)==null||e.open(),O()},B=()=>{var s;(s=p.value)==null||s.resetFields()};return C({open:w}),(s,e)=>{const c=U,n=Y,i=A,D=I,N=T;return _(),k("div",j,[l(F,{ref_key:"popupRef",ref:m,title:"设置存储",async:!0,width:"550px",onConfirm:K,onClose:B},{default:r(()=>[l(N,{ref_key:"formRef",ref:p,model:o(t),"label-width":"120px",rules:x},{default:r(()=>[l(n,{label:"存储方式",prop:"engine"},{default:r(()=>{var a;return[u("div",null,[l(c,{"model-value":""},{default:r(()=>{var S;return[f(E((S=o(b))==null?void 0:S.name),1)]}),_:1}),u("div",z,E((a=o(b))==null?void 0:a.tips),1)])]}),_:1}),o(t).engine!=="local"?(_(),k("div",H,[l(n,{label:" 存储空间名称",prop:"bucket"},{default:r(()=>[u("div",J,[l(i,{modelValue:o(t).bucket,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).bucket=a),placeholder:"请输入存储空间名称(Bucket)",clearable:""},null,8,["modelValue"])])]),_:1}),l(n,{label:"ACCESS_KEY",prop:"access_key"},{default:r(()=>[l(i,{modelValue:o(t).access_key,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).access_key=a),placeholder:"请输入ACCESS_KEY(AK)",clearable:""},null,8,["modelValue"])]),_:1}),l(n,{label:"SECRET_KEY",prop:"secret_key"},{default:r(()=>[l(i,{modelValue:o(t).secret_key,"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).secret_key=a),placeholder:"请输入SECRET_KEY(SK)",clearable:""},null,8,["modelValue"])]),_:1}),l(n,{label:"空间域名",prop:"domain"},{default:r(()=>[u("div",Q,[u("div",null,[l(i,{modelValue:o(t).domain,"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).domain=a),placeholder:"请输入空间域名(Domain)",clearable:""},null,8,["modelValue"])]),e[6]||(e[6]=u("div",{class:"form-tips"}," 请补全http://或https://，例如https://static.cloud.com ",-1))])]),_:1}),o(t).engine=="qcloud"?(_(),M(n,{key:0,label:"REGION",prop:"region"},{default:r(()=>[l(i,{modelValue:o(t).region,"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).region=a),placeholder:"请输入region",clearable:""},null,8,["modelValue"])]),_:1})):V("",!0)])):V("",!0),l(n,{label:"状态",prop:"status"},{default:r(()=>[l(D,{modelValue:o(t).status,"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).status=a)},{default:r(()=>[l(c,{label:0},{default:r(()=>e[7]||(e[7]=[f("关闭")])),_:1}),l(c,{label:1},{default:r(()=>e[8]||(e[8]=[f("开启")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)])}}});export{le as _,te as s};
